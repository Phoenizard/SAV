Note: è¯·ä½¿ç”¨pytorchæ¡†æ¶ï¼Œå°½é‡ä¸è¦ä½¿ç”¨torchä¸­çš„è‡ªå¸¦ä¼˜åŒ–å™¨

### æ¨¡å‹ç»“æ„

ä»¤$\theta = (\mathbf{W}, \vec{a})$ç°åœ¨æœ‰ç¥ç»ç½‘ç»œæ¨¡å‹ï¼Œ Xå·²ç»ç”¨1å¢å¹¿ï¼Œæ²¡æœ‰åç½®:

$$
f(\vec{x}, \theta)=\frac{1}{m}\sum_{i=1}^m a_i \cdot relu(W_i^T \vec{x})
$$

å…¶ä¸­ï¼Œmä¸ºéšè—å±‚ç»´åº¦ï¼Œè¾“å…¥ç»´åº¦Xä¸º(D + 1)ï¼Œæ‰€ä»¥å‚æ•°Wçš„å½¢çŠ¶ä¸º $(D+1)*m$ ,a ä¸º $m*1$ çš„å‘é‡ï¼Œè¾“å‡ºä¸ºscalarã€‚

å®šä¹‰æŸå¤±å‡½æ•°Iä¸ºï¼š

$$
I = \int_{R^D} (f(\theta) - f^*)^2 d\vec{x} := \frac{1}{N}\sum_{i=1}^N {(f - f^*)^2}
$$

### æ•°æ®é›†

å®šä¹‰ç›®æ ‡å‡½æ•°ï¼š

$$
f(x_1, \cdots, x_D) = \sin(\sum_{i=1}^D p_ix_i) + \cos(\sum_{i=1}^D q_ix_i)
$$

${ğ‘ğ‘–,ğ‘ğ‘–}_{1â‰¤ğ‘–â‰¤ğ·}$ è¯·ä½ ç”Ÿæˆæ•°æ®é›† ${ğ±_ğ‘—,ğ‘“âˆ—_ğ‘— }_{1â‰¤ğ‘—â‰¤ğ‘€}$, å…¶ä¸­$ğ±_ğ‘—âˆˆ(0, 1)_ğ·$

è¯·ç”¨Z-score normalizationé¢„å¤„ç†æ•°æ®,æ•°æ®é›†è¦æ±‚D=20,ç”ŸæˆMæ¡ï¼ŒM=10000ã€‚

åœ¨è®­ç»ƒæ—¶ï¼Œè¯·ä½¿ç”¨mini-batchæŠ€æœ¯ï¼Œå®šä¹‰batch sizeä¸º256ï¼›è®­ç»ƒé›†å’Œæµ‹è¯•é›†ä¸º8:2

### ç®—æ³•

å°†æœºå™¨å­¦ä¹ ä¼˜åŒ–é—®é¢˜çœ‹ä½œå¦‚ä¸‹æ¡†æ¶ï¼š

$$
\frac{d\theta}{dt} = -\frac{\delta I(\theta)}{\delta \theta} := -N(\theta)
$$

åœ¨æ¯ä¸€ä¸ªepochä¸­ï¼Œè¿›è¡Œå¦‚ä¸‹æ›´æ–°ï¼š

è¾“å…¥:

åˆå§‹å‚æ•°: $\theta_0$ 

æ—¶é—´æ­¥é•¿: $\Delta t$ 

æ ‡é‡è¾…åŠ©å˜é‡åˆå€¼: $r_0 = \sqrt{I(\theta_0) + C}$

å…·ä½“æ­¥éª¤ï¼š

1.	åˆå§‹åŒ–: è®¾å®šåˆå§‹å‚æ•°$\theta_0$å’Œåˆå§‹æ ‡é‡å˜é‡$r_0$ ã€‚

2.	å¾ªç¯è¿­ä»£ (ä»  $n = 0$  åˆ°  $N - 1$ )ï¼š
	
    æ­¥éª¤ 1: è®¡ç®—ä¸­é—´å‚æ•°$\theta_{n+1,1} = \theta_n$ ã€‚
	æ­¥éª¤ 2: æ›´æ–°ç¬¬äºŒä¸ªä¸­é—´å‚æ•°$\theta_{n+1,2}$ ï¼Œè®¡ç®—å…¬å¼ä¸ºï¼š
    $$
    \theta_{n+1,2} = -\Delta t \sqrt{\mathcal{I}(\theta_n) + C} \cdot (I + \Delta t \mathcal{L})^{-1} \mathcal{N}(\theta_n)
    $$
    æ­¥éª¤ 3: æ›´æ–°æ ‡é‡è¾…åŠ©å˜é‡ $r_{n+1}$ 
    $$
    r_{n+1} = \frac{r_n}{1 + \Delta t \cdot \frac{(\mathcal{N}(\theta_n), (I + \Delta t \mathcal{L})^{-1} \mathcal{N}(\theta_n))}{2(\mathcal{I}(\theta_n) + C)}}
    $$
    æ­¥éª¤ 4: æ›´æ–°å‚æ•°ï¼š
    $$
    \theta_{n+1} = \theta_{n+1,1} + r_{n+1} \cdot \theta_{n+1,2}
    $$

3.	è¿”å›: æœ€ç»ˆçš„å‚æ•°  $\theta_N$ ã€‚